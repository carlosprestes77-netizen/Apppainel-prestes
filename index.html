<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#e8e1d5" />
<link rel="manifest" href="manifest.webmanifest" />

<title>Painel Prestes</title>

<style>
/* -----------------------
   VARIÁVEIS DE TEMA
------------------------*/
:root {
  --bg: #f7f3ed;
  --card: #ffffff;
  --text: #3b3b3b;
  --subtext: #7f7f7f;
  --border: #e2dcd4;
  --accent: #bba98a;
  --accent-strong: #8d7a58;
  --pill-bg: #efe8dd;
  --pill-text: #6d5c48;
  --circle-start: #e2d6c3;
  --circle-end: #f4eee6;
  --shadow: rgba(0,0,0,0.08);
  --transition: 0.25s ease;
}

/* MODO ESCURO CHAMPAGNE */
.dark {
  --bg: #1c1b19;
  --card: #272521;
  --text: #f4eede;
  --subtext: #b7ad98;
  --border: #3a3834;
  --accent: #d1b892;
  --accent-strong: #c1a277;
  --pill-bg: #3c372f;
  --pill-text: #e6d8bf;
  --circle-start: #9b8a6b;
  --circle-end: #cbbca3;
  --shadow: rgba(0,0,0,0.55);
}

html {
  transition: var(--transition);
}

body {
  margin:0;
  padding:20px;
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, "Sf Pro", Roboto, sans-serif;
  transition: var(--transition);
  display:flex;
  justify-content:center;
}

.app {
  width:100%;
  max-width:1050px;
}

/* HEADER PREMIUM */
.header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:20px;
}

.logo-wrap {
  display:flex;
  align-items:center;
  gap:12px;
}

.logo-circle {
  width:52px;
  height:52px;
  border-radius:50%;
  background: linear-gradient(135deg, var(--circle-start), var(--circle-end));
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.35rem;
  font-weight:700;
  color: var(--accent-strong);
  box-shadow:0 4px 14px var(--shadow);
  letter-spacing:1px;
}

/* NOME */
h1 {
  margin:0;
  font-size:1.48rem;
  font-weight:700;
  color: var(--text);
}

.sub {
  margin:0;
  color: var(--subtext);
  font-size:0.82rem;
}

/* TOGGLE TEMA */
.theme-toggle {
  cursor:pointer;
  width:48px;
  height:26px;
  border-radius:30px;
  background: var(--border);
  display:flex;
  align-items:center;
  padding:3px;
  transition: var(--transition);
  position:relative;
}

.theme-ball {
  width:20px;
  height:20px;
  border-radius:50%;
  background: var(--accent);
  transition: var(--transition);
}

.dark .theme-toggle {
  background:#4e4a44;
}

.dark .theme-ball {
  transform:translateX(22px);
  background: var(--accent-strong);
}

/* ABAS */
.tabs {
  display:flex;
  gap:10px;
  margin-top:10px;
  border-bottom:1px solid var(--border);
  padding-bottom:8px;
}

.tab {
  padding:8px 16px;
  border-radius:10px;
  font-size:0.9rem;
  cursor:pointer;
  color: var(--subtext);
  transition: var(--transition);
}

.tab.active {
  background: var(--card);
  color: var(--text);
  box-shadow:0 3px 8px var(--shadow);
}

/* CARDS PREMIUM */
.card {
  background: var(--card);
  padding:18px;
  border-radius:18px;
  margin-top:18px;
  box-shadow:0 4px 14px var(--shadow);
  border:1px solid var(--border);
  transition: var(--transition);
}

.card h3 {
  margin:0 0 10px 0;
  font-size:1.05rem;
}

/* INPUTS */
input, button {
  width:100%;
  margin-top:8px;
  padding:12px 13px;
  border-radius:14px;
  border:1px solid var(--border);
  background: var(--card);
  color: var(--text);
  font-size:0.9rem;
  transition: var(--transition);
}

input::placeholder {
  color: var(--subtext);
}

/* BOTÕES */
button {
  background: var(--accent);
  color:#fff;
  font-weight:600;
  border:none;
  cursor:pointer;
  box-shadow:0 4px 14px var(--shadow);
}

button:hover {
  filter:brightness(1.05);
}

button.danger {
  background:#b94a4a;
}

/* CALENDÁRIO */
.calendar {
  margin-top:15px;
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:8px;
}

.weekday {
  text-align:center;
  font-size:0.75rem;
  font-weight:600;
  color: var(--subtext);
}

.day {
  min-height:82px;
  background: var(--card);
  border-radius:16px;
  padding:6px;
  border:1px solid var(--border);
  cursor:pointer;
  transition: var(--transition);
  box-shadow:0 3px 10px var(--shadow);
  position:relative;
}

.day:hover {
  transform:scale(1.03);
}

.day.empty {
  background:transparent;
  border:none;
  box-shadow:none;
  cursor:default;
}

.day strong {
  font-size:0.85rem;
  color: var(--text);
}

/* EVENTOS */
.event-pill {
  margin-top:4px;
  padding:4px 6px;
  font-size:0.72rem;
  border-radius:12px;
  background: var(--pill-bg);
  color: var(--pill-text);
  font-weight:600;
  box-shadow:0 2px 6px var(--shadow);
}

.event-pill.paid {
  background:#d6ead9;
  color:#1e6d3a;
}

.event-pill.pending {
  background:#fcecdc;
  color:#c27841;
}

/* TEXTO AUXILIAR */
.info-small {
  margin-top:5px;
  font-size:0.8rem;
  color: var(--subtext);
}

/* TABELA DE DÍVIDAS */
table {
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

td, th {
  border-bottom:1px solid var(--border);
  padding:8px;
  font-size:0.85rem;
}

th {
  color: var(--subtext);
  text-transform:uppercase;
  font-size:0.7rem;
}
</style>
</head>
<body>
<div class="app">

  <!-- TOPO COM LOGO CP -->
  <div class="header">
    <div class="logo-wrap">
      <div class="logo-circle">CP</div>
      <div>
        <h1>Painel Prestes</h1>
        <p class="sub">Organização premium do fotógrafo + advogado</p>
      </div>
    </div>

    <!-- Toggle Sol / Lua -->
    <div class="theme-toggle" id="themeToggle">
      <div class="theme-ball"></div>
    </div>
  </div>

  <!-- ABAS -->
  <div class="tabs">
    <div class="tab active" data-tab="calendario">Calendário</div>
    <div class="tab" data-tab="eventos">Eventos</div>
    <div class="tab" data-tab="financeiro">Financeiro</div>
  </div>

  <!-- CONTEÚDO DAS ABAS -->
  <div id="conteudo">

    <!-- ABA CALENDÁRIO -->
    <div class="tab-content" id="aba-calendario">
      <div class="card">
        <h3>Calendário</h3>

        <div id="calendarHeader" style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <button id="prevMonth">◀</button>
          <h3 id="monthLabel"></h3>
          <button id="nextMonth">▶</button>
        </div>

        <div class="calendar" id="calendar"></div>
      </div>
    </div>

    <!-- ABA EVENTOS -->
    <div class="tab-content" id="aba-eventos" style="display:none;">
      <div class="card">
        <h3>Novo Evento</h3>

        <input type="date" id="eventDate" />
        <input type="text" id="eventEmpresa" placeholder="Empresa" />
        <input type="text" id="eventServico" placeholder="Serviço" />
        <input type="number" id="eventValor" placeholder="Valor" />
        <input type="number" id="eventRecebido" placeholder="Recebido parcial (opcional)" />

        <select id="eventPago" style="margin-top:10px; padding:12px; border-radius:14px; border:1px solid var(--border); background:var(--card); color:var(--text);">
          <option value="nao">Não Pago</option>
          <option value="sim">Pago</option>
        </select>

        <button id="addEvent" style="margin-top:14px;">Adicionar evento</button>
      </div>

      <div class="card">
        <h3>Lista de eventos</h3>
        <div id="listaEventos"></div>
      </div>
    </div>

    <!-- ABA FINANCEIRO -->
    <div class="tab-content" id="aba-financeiro" style="display:none;">
      <div class="card">
        <h3>Resumo financeiro</h3>
        <p class="info-small">Cálculo automático do que entrou, do que falta e do que foi só parcial.</p>

        <table>
          <tr>
            <th>Total do mês</th>
            <td id="totalMes">R$ 0,00</td>
          </tr>
          <tr>
            <th>Recebido</th>
            <td id="totalRecebido">R$ 0,00</td>
          </tr>
          <tr>
            <th>Falta receber</th>
            <td id="totalFalta">R$ 0,00</td>
          </tr>
        </table>
      </div>
    </div>

  </div>

</div>
<script>
/* -----------------------------
   TEMA (CLARO / ESCURO)
------------------------------*/
const themeToggle = document.getElementById("themeToggle");

function loadTheme() {
  const saved = localStorage.getItem("theme");
  if (saved === "dark") {
    document.documentElement.classList.add("dark");
    return;
  }
  document.documentElement.classList.remove("dark");
}
loadTheme();

themeToggle.addEventListener("click", () => {
  document.documentElement.classList.toggle("dark");
  const isDark = document.documentElement.classList.contains("dark");
  localStorage.setItem("theme", isDark ? "dark" : "light");
});

/* -----------------------------
   TROCA ENTRE ABAS
------------------------------*/
const tabs = document.querySelectorAll(".tab");
tabs.forEach(tab => {
  tab.addEventListener("click", () => {
    document.querySelector(".tab.active").classList.remove("active");
    tab.classList.add("active");

    const name = tab.dataset.tab;
    document.querySelectorAll(".tab-content").forEach(el => (el.style.display = "none"));
    document.getElementById("aba-" + name).style.display = "block";
  });
});

/* -----------------------------
   CALENDÁRIO
------------------------------*/
let currentDate = new Date();
const monthLabel = document.getElementById("monthLabel");
const calendar = document.getElementById("calendar");

function renderCalendar() {
  calendar.innerHTML = "";
  const year = currentDate.getFullYear();
  const month = currentDate.getMonth();

  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const firstWeekday = firstDay.getDay();

  const monthNames = [
    "Janeiro","Fevereiro","Março","Abril","Maio","Junho",
    "Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"
  ];
  monthLabel.textContent = monthNames[month] + " " + year;

  const weekdays = ["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];
  weekdays.forEach(w => {
    const wd = document.createElement("div");
    wd.className = "weekday";
    wd.textContent = w;
    calendar.appendChild(wd);
  });

  for (let i = 0; i < firstWeekday; i++) {
    const empty = document.createElement("div");
    empty.className = "day empty";
    calendar.appendChild(empty);
  }

  const events = JSON.parse(localStorage.getItem("eventos") || "[]");

  for (let d = 1; d <= lastDay.getDate(); d++) {
    const box = document.createElement("div");
    box.className = "day";

    const dateStr = `${year}-${String(month + 1).padStart(2, "0")}-${String(d).padStart(2, "0")}`;
    box.innerHTML = `<strong>${d}</strong>`;

    const dayEvents = events.filter(e => e.data === dateStr);
    dayEvents.forEach(ev => {
      const pill = document.createElement("div");
      pill.className = "event-pill";
      pill.textContent = `${ev.empresa}`;
      if (ev.pago === "sim") pill.classList.add("paid");
      if (ev.recebido && ev.recebido > 0 && ev.pago === "nao") pill.classList.add("pending");
      box.appendChild(pill);
    });

    calendar.appendChild(box);
  }
}

document.getElementById("prevMonth").onclick = () => {
  currentDate.setMonth(currentDate.getMonth() - 1);
  renderCalendar();
};

document.getElementById("nextMonth").onclick = () => {
  currentDate.setMonth(currentDate.getMonth() + 1);
  renderCalendar();
};

/* -----------------------------
   EVENTOS
------------------------------*/
function atualizarListaEventos() {
  const eventos = JSON.parse(localStorage.getItem("eventos") || "[]");
  const lista = document.getElementById("listaEventos");
  lista.innerHTML = "";

  eventos.forEach((ev, i) => {
    const div = document.createElement("div");
    div.className = "event-pill";
    div.style.display = "flex";
    div.style.justifyContent = "space-between";
    div.style.alignItems = "center";
    div.style.margin = "8px 0";

    div.innerHTML = `
      <span><b>${ev.data}</b> • ${ev.empresa} • R$ ${Number(ev.valor).toFixed(2)}</span>
      <button class="danger" data-i="${i}" style="width:auto; padding:6px 10px; font-size:0.75rem;">Excluir</button>
    `;

    lista.appendChild(div);
  });

  document.querySelectorAll(".danger").forEach(btn => {
    btn.onclick = () => {
      const eventos = JSON.parse(localStorage.getItem("eventos") || "[]");
      eventos.splice(btn.dataset.i, 1);
      localStorage.setItem("eventos", JSON.stringify(eventos));
      atualizarListaEventos();
      renderCalendar();
      atualizarFinanceiro();
    };
  });
}

document.getElementById("addEvent").onclick = () => {
  const data = document.getElementById("eventDate").value;
  const empresa = document.getElementById("eventEmpresa").value;
  const servico = document.getElementById("eventServico").value;
  const valor = Number(document.getElementById("eventValor").value);
  const recebido = Number(document.getElementById("eventRecebido").value || 0);
  const pago = document.getElementById("eventPago").value;

  if (!data || !empresa || !servico || !valor) {
    alert("Preencha todos os campos obrigatórios!");
    return;
  }

  const eventos = JSON.parse(localStorage.getItem("eventos") || "[]");
  eventos.push({ data, empresa, servico, valor, recebido, pago });
  localStorage.setItem("eventos", JSON.stringify(eventos));

  atualizarListaEventos();
  renderCalendar();
  atualizarFinanceiro();

  document.getElementById("eventEmpresa").value = "";
  document.getElementById("eventServico").value = "";
  document.getElementById("eventValor").value = "";
  document.getElementById("eventRecebido").value = "";
  document.getElementById("eventPago").value = "nao";
};

/* -----------------------------
   FINANCEIRO
------------------------------*/
function atualizarFinanceiro() {
  const eventos = JSON.parse(localStorage.getItem("eventos") || "[]");

  let total = 0;
  let recebido = 0;

  eventos.forEach(ev => {
    total += ev.valor;

    if (ev.pago === "sim") {
      recebido += ev.valor;
    } else if (ev.recebido && ev.recebido > 0) {
      recebido += ev.recebido;
    }
  });

  const falta = total - recebido;

  document.getElementById("totalMes").textContent = `R$ ${total.toFixed(2)}`;
  document.getElementById("totalRecebido").textContent = `R$ ${recebido.toFixed(2)}`;
  document.getElementById("totalFalta").textContent = `R$ ${falta.toFixed(2)}`;
}

/* -----------------------------
   INICIALIZAÇÃO
------------------------------*/
renderCalendar();
atualizarListaEventos();
atualizarFinanceiro();

/* -----------------------------
   PWA
------------------------------*/
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js").catch(err => console.log("SW error:", err));
}
</script>
</body>
</html>
